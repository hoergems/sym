#include "integrate.hpp"

using namespace boost::numeric::odeint;
using std::endl;
using std::cout;

namespace shared{

template<class T>
struct VecToList
{
    static PyObject* convert(const std::vector<T>& vec)
    {
        boost::python::list* l = new boost::python::list();
        for(size_t i = 0; i < vec.size(); i++)
            (*l).append(vec[i]);

        return l->ptr();
    }
};

Integrate::Integrate(double k) {	
	cout << "Hello" << endl;
}

void Integrate::do_integration(std::vector<double> &x, std::vector<double> &int_times) const {
	double t0 = int_times[0];
	double te = int_times[1];
	double step_size = int_times[2];
	cout << "integrate" << endl;
	for(size_t i = 0; i < x.size(); i++) {
		    cout << x[i] << " " << endl;	
	}
	size_t k = integrate_const(runge_kutta4<state_type>() ,
		                       std::bind(&Integrate::ode , this , pl::_1 , pl::_2 , pl::_3),
		                       x , t0 , te , step_size);
	cout << "k " << k << endl;
	for(size_t i = 0; i < x.size(); i++) {
	    cout << x[i] << " " << endl;	
	}
}

void Integrate::setup(std::vector<double> &thetas_star, 
		              std::vector<double> &dot_thetas_star, 
		              std::vector<double> &rhos_star) {	
	thetas_star_.clear();
	dot_thetas_star_.clear();
	rhos_star_.clear();
	for (size_t i = 0; i < thetas_star.size(); i++) {
		thetas_star_.push_back(thetas_star[i]);
		dot_thetas_star_.push_back(dot_thetas_star[i]);
		rhos_star_.push_back(rhos_star[i]);
	}
	cout << "setup" << endl;
}

void Integrate::ode(const state_type &x , state_type &dxdt , double t) const {std::vector<double> terms({x[3], x[4], (-dot_thetas_star_[0] + x[3])*(400.0*dot_thetas_star_[0]*sin(1.0*thetas_star_[0]) + 390.625*dot_thetas_star_[0]*sin(1.0*thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[0]*sin(1.0*thetas_star_[1]) - 195.3125*dot_thetas_star_[0]*sin(2.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[1]*sin(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))/(204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875) + (-dot_thetas_star_[1] + x[4])*(-200.0*dot_thetas_star_[0]*sin(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[1]*sin(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))/(204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875) + (-thetas_star_[0] + x[0])*((204.6875*sin(1.0*thetas_star_[0]) - 195.3125*sin(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 195.3125*sin(2.0*thetas_star_[0] + 2.0*thetas_star_[1]))*(200.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0]) + 195.3125*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1]) - 97.65625*pow(dot_thetas_star_[0], 2)*sin(2.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 40.0*rhos_star_[0] + 78.125*rhos_star_[1]*cos(1.0*thetas_star_[1]) - 78.125*rhos_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 40.0*rhos_star_[1]) + (204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875)*(-195.3125*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1])*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 200.0*pow(dot_thetas_star_[0], 2)*cos(1.0*thetas_star_[0]) + 100.0*pow(dot_thetas_star_[0], 2)*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[1], 2)*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 78.125*rhos_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))/pow(204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875, 2) + (-thetas_star_[1] + x[1])*((195.3125*sin(2.0*thetas_star_[1]) - 390.625*sin(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 195.3125*sin(2.0*thetas_star_[0] + 2.0*thetas_star_[1]))*(200.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0]) + 195.3125*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1]) - 97.65625*pow(dot_thetas_star_[0], 2)*sin(2.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 40.0*rhos_star_[0] + 78.125*rhos_star_[1]*cos(1.0*thetas_star_[1]) - 78.125*rhos_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 40.0*rhos_star_[1]) + (204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875)*(-195.3125*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1])*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 195.3125*pow(dot_thetas_star_[0], 2)*cos(1.0*thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[0], 2)*cos(1.0*thetas_star_[1]) - 195.3125*pow(dot_thetas_star_[0], 2)*cos(2.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[0], 2)*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*cos(1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[1], 2)*cos(1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[1], 2)*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 78.125*rhos_star_[1]*sin(1.0*thetas_star_[1]) + 78.125*rhos_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))/pow(204.6875*cos(1.0*thetas_star_[0]) + 97.65625*cos(2.0*thetas_star_[1]) - 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 204.6875, 2) + (-200.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0]) - 195.3125*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[1]) + 97.65625*pow(dot_thetas_star_[0], 2)*sin(2.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[0], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[1]) - 200.0*dot_thetas_star_[0]*dot_thetas_star_[1]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[1]) - 100.0*pow(dot_thetas_star_[1], 2)*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 40.0*rhos_star_[0] - 78.125*rhos_star_[1]*cos(1.0*thetas_star_[1]) + 78.125*rhos_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 40.0*rhos_star_[1])/(-204.6875*cos(1.0*thetas_star_[0]) - 97.65625*cos(2.0*thetas_star_[1]) + 195.3125*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 97.65625*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 204.6875), -(-dot_thetas_star_[0] + x[3])*(5.0*dot_thetas_star_[0]*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28)*sin(1.0*thetas_star_[1]) + 2*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28))/(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55) + (dot_thetas_star_[0] + dot_thetas_star_[1])*(-dot_thetas_star_[1] + x[4])*(5.0*sin(1.0*thetas_star_[1]) - 5.0*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28)/(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55) + (-thetas_star_[0] + x[0])*(-(6.55*sin(1.0*thetas_star_[0]) - 6.25*sin(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 6.25*sin(2.0*thetas_star_[0] + 2.0*thetas_star_[1]))*(2.5*pow(dot_thetas_star_[0], 2)*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28)*sin(1.0*thetas_star_[1]) - rhos_star_[0]*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28) - rhos_star_[1]*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28) + (dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28)) + (2.5*pow(dot_thetas_star_[0], 2)*(10.0*sin(1.0*thetas_star_[0]) + 5.0*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))*sin(1.0*thetas_star_[1]) + 2.5*rhos_star_[0]*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - rhos_star_[1]*(10.0*sin(1.0*thetas_star_[0]) + 5.0*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - 2.5*(dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - (dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*cos(1.0*thetas_star_[0]) + 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) + 2.5*dot_thetas_star_[1]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) + 2.5*dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28))*(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55))/pow(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55, 2) + (-thetas_star_[1] + x[1])*(-(6.25*sin(2.0*thetas_star_[1]) - 12.5*sin(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 6.25*sin(2.0*thetas_star_[0] + 2.0*thetas_star_[1]))*(2.5*pow(dot_thetas_star_[0], 2)*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28)*sin(1.0*thetas_star_[1]) - rhos_star_[0]*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28) - rhos_star_[1]*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28) + (dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28)) + (6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55)*(-2.5*pow(dot_thetas_star_[0], 2)*(5.0*sin(1.0*thetas_star_[1]) - 5.0*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))*sin(1.0*thetas_star_[1]) - 2.5*pow(dot_thetas_star_[0], 2)*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28)*cos(1.0*thetas_star_[1]) - rhos_star_[0]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) + rhos_star_[1]*(5.0*sin(1.0*thetas_star_[1]) - 5.0*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) + (dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - (dot_thetas_star_[0]*(2.5*dot_thetas_star_[0]*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - dot_thetas_star_[1]*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28)))/pow(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55, 2) + (-2.5*pow(dot_thetas_star_[0], 2)*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28)*sin(1.0*thetas_star_[1]) + rhos_star_[0]*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28) + rhos_star_[1]*(10.0*cos(1.0*thetas_star_[0]) - 5.0*cos(1.0*thetas_star_[1]) + 5.0*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) - 11.28) - (dot_thetas_star_[0]*(dot_thetas_star_[0]*(5.0*sin(1.0*thetas_star_[0]) + 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])) - dot_thetas_star_[1]*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1]))) - dot_thetas_star_[1]*(dot_thetas_star_[0] + dot_thetas_star_[1])*(2.5*sin(1.0*thetas_star_[1]) - 2.5*sin(1.0*thetas_star_[0] + 1.0*thetas_star_[1])))*(2.5*cos(1.0*thetas_star_[1]) - 2.5*cos(1.0*thetas_star_[0] + 1.0*thetas_star_[1]) + 1.28))/(6.55*cos(1.0*thetas_star_[0]) + 3.125*cos(2.0*thetas_star_[1]) - 6.25*cos(1.0*thetas_star_[0] + 2.0*thetas_star_[1]) + 3.125*cos(2.0*thetas_star_[0] + 2.0*thetas_star_[1]) - 6.55)});dxdt.clear();for(size_t i = 0; i < x.size(); i++) { dxdt.push_back(terms[i]); }} 

BOOST_PYTHON_MODULE(libintegrate) {
    using namespace boost::python;
    
    class_<std::vector<double> > ("v_double")
             .def(vector_indexing_suite<std::vector<double> >());
    
    class_<Integrate>("Integrate", init<double>())
                        .def("doIntegration", &Integrate::do_integration) 
                        .def("setup", &Integrate::setup)                        
    ;
}

}